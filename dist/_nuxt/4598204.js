(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1428:function(t,e,n){var content=n(1455);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(39).default)("7491d665",content,!0,{sourceMap:!1})},1431:function(t,e,n){"use strict";n.r(e);var o=n(786),r=n(1696),c=n(1388),l=n(1398),d=n(540),f=n(424),h=n(544),v=n(539),x=n(1387),m=n(134),_=n(1386),k=n(21),y=(n(106),n(119),n(1447)),C=n(565),w=n(1432),M={components:{VueQrcode:n.n(w).a},data:function(){return{mixinMessengerLogo:"https://static.fox.one/image/icon_mixin@32x32.png",qrUrl:"",qrLoaded:!1,accessToken:null,outputs:null,client:null}},computed:{connectMixinDialog:{get:function(){return this.$store.state.connectMixinDialog},set:function(t){this.$store.commit("toggleConnectMixin",t)}},mixinConnected:{get:function(){return this.$store.state.mixinConnected},set:function(t){this.$store.commit("connectMixin",t)}}},mounted:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.client=t.auth();case 1:case"end":return e.stop()}}),e)})))()},watch:{connectMixinDialog:function(t){t&&(this.client=this.auth())}},methods:{qrAfterSuccess:function(){var t=this;setTimeout((function(){t.qrUrl="",t.connectMixinDialog=!1}),1e3)},redirect:function(t){location.href=t},auth:function(){var t,e=this;Object(y.a)({clientId:"a13f4c77-5cfc-4368-a2d6-33f07037ae9e",scope:"PROFILE:READ",pkce:!0},{onShowUrl:function(t){e.qrUrl=t,e.qrLoaded=!0},onError:function(t){e.connectMixinDialog=!1,console.error(t)},onSuccess:(t=Object(k.a)(regeneratorRuntime.mark((function t(data){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.accessToken=data,e.qrAfterSuccess(),t.next=4,Object(C.i)(data);case 4:return n=t.sent,e.mixinConnected=!0,e.$store.commit("connectMixin",!0),e.$store.commit("setOauthUser",n),localStorage.setItem("access_token",data),localStorage.setItem("oauth_user",JSON.stringify(n)),t.abrupt("return");case 11:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)})})}}},O=M,D=(n(1454),n(57)),component=Object(D.a)(O,(function(){var t=this,e=t._self._c;return e(l.a,{staticClass:"dialog-css",attrs:{"max-width":"500px","overlay-opacity":"0.5"},model:{value:t.connectMixinDialog,callback:function(e){t.connectMixinDialog=e},expression:"connectMixinDialog"}},[t.$vuetify.breakpoint.mobile?e(m.a,{staticClass:"align-self-start px-9 py-8"},[e(x.a,{staticClass:"d-flex flex-column mb-0"},[e(c.a,{staticClass:"align-center d-flex flex-row pa-0 mb-2"},[e(_.a),t._v(" "),e(o.a,{attrs:{icon:""},on:{click:function(e){t.connectMixinDialog=!1}}},[e(d.a,{attrs:{color:"black"}},[t._v(" mdi-close ")])],1)],1),t._v(" "),t.qrLoaded?e(c.a,{staticClass:"d-flex justify-center oauth-qr-mobile-background"},[e(o.a,{attrs:{elevation:"0",color:"#ebf8ff"},on:{click:function(e){return t.redirect(t.qrUrl)}}},[e(f.a,{staticClass:"mr-2 mixin-logo-overlay",attrs:{src:t.mixinMessengerLogo}}),t._v(" "),e("span",[t._v(" "+t._s(t.$t("mixin_oauth_mobile_title"))+" ")]),t._v(" "),t.mixinConnected?e(d.a,{staticClass:"ml-1",attrs:{size:"16px",color:"green"}},[t._v("\n            mdi-checkbox-marked-circle\n          ")]):t._e()],1)],1):t._e()],1)],1):e(m.a,{staticClass:"align-self-start px-9 py-8"},[e(x.a,{staticClass:"d-flex flex-column mb-0"},[e(c.a,{staticClass:"align-center d-flex flex-row pa-0 mb-2"},[e(_.a),t._v(" "),e(o.a,{attrs:{icon:""},on:{click:function(e){t.connectMixinDialog=!1}}},[e(d.a,{attrs:{color:"black"}},[t._v(" mdi-close ")])],1)],1),t._v(" "),t.qrLoaded?e(c.a,{staticClass:"py-6 d-flex justify-center oauth-qr-background"},[e(r.a,{attrs:{"max-width":"200px"}},[e(x.a,[t.qrUrl?e("vue-qrcode",{attrs:{value:t.qrUrl,options:{width:200}}}):t._e(),t._v(" "),e(h.a,{attrs:{opacity:"0",absolute:""}},[t.mixinConnected?t._e():e(f.a,{staticClass:"mixin-logo-overlay",attrs:{src:t.mixinMessengerLogo}}),t._v(" "),t.mixinConnected?e(d.a,{staticClass:"oauth-qr-scanned",attrs:{size:"64px"}},[t._v("\n                mdi-checkbox-marked-circle\n              ")]):t._e()],1)],1)],1)],1):t._e(),t._v(" "),t.qrLoaded?t._e():e(c.a,{staticClass:"my-10 d-flex justify-center"},[e(v.a,{attrs:{indeterminate:"",color:"primary"}})],1),t._v(" "),e("div",{staticClass:"my-5"},[e(c.a,{staticClass:"d-flex justify-start"},[e("span",{staticClass:"oauth-guide-title"},[t._v("\n            "+t._s(t.$t("mixin_oauth_title"))+"\n          ")])]),t._v(" "),e(c.a,{staticClass:"d-flex justify-start"},[e("span",{staticClass:"oauth-guide-text"},[t._v("\n            "+t._s(t.$t("mixin_oauth_text"))+"\n          ")])])],1)],1)],1)],1)}),[],!1,null,"2fa10296",null);e.default=component.exports},1447:function(t,e,n){"use strict";n.d(e,"a",(function(){return w}));var o=n(89),r=n(90),c=(n(50),n(114),n(12),n(139),n(1520),n(1521),n(1522),n(1523),n(1524),n(1525),n(1526),n(1527),n(1528),n(1529),n(1530),n(1531),n(1532),n(1533),n(1534),n(1535),n(1536),n(1537),n(1538),n(1539),n(1540),n(1541),n(1542),n(1543),n(1544),n(106),n(1545)),l=n(1546),d=n(1547),f=n(188),h=n(1548),v=n.n(h),x=n(1550),m=n.n(x),_=n(154),k=n.n(_);function y(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function C(){var t=function(t){for(var text="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<t;i++)text+=e.charAt(Math.floor(Math.random()*e.length));return text}(32);return{verifier:y(btoa(t)),challenge:y(v()(t).toString(m.a))}}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="https://api.mixin.one",o="wss://blaze.mixin.one",r=n,c=o,l=new M(r,c),d=!1,f=t.pkce?C():{},h=f.challenge,v=void 0===h?"":h,x=f.verifier,m=void 0===x?"":x,_=function(n){var o,c,l,f,data=n.data;if(400===(null==n||null===(o=n.error)||void 0===o?void 0:o.code)||10002===(null==n||null===(c=n.error)||void 0===c?void 0:c.code))return null===(f=e.onError)||void 0===f||f.call(e,null==n?void 0:n.error),!0;if(!data)return!1;if(data.authorization_code.length>16){var h;if(t.pkce)k.a.post("/oauth/token",{client_id:t.clientId,code_verifier:m,code:data.authorization_code},{baseURL:r}).then((function(data){var t,n,o,r,c=null==data||null===(t=data.data)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.access_token;c?null===(o=e.onSuccess)||void 0===o||o.call(e,c):null===(r=e.onError)||void 0===r||r.call(e,{description:"Get PKCE access token error"})})).catch((function(t){var n;null===(n=e.onError)||void 0===n||n.call(e,t)}));else null===(h=e.onSuccess)||void 0===h||h.call(e,data.authorization_code);return!0}return d||(null===(l=e.onShowUrl)||void 0===l||l.call(e,"mixin://codes/"+data.code_id),d=!0),!1};return l.connect(_,t.clientId,t.scope,v),l}var M=function(){function t(e,n){Object(o.a)(this,t),this.api=e,this.endpoint=n}return Object(r.a)(t,[{key:"disconnect",value:function(){this.ws.close()}},{key:"connect",value:function(t,e,n,o){var r=this;r.handled=!1,r.callback=t,r.ws=new c.a(r.endpoint,"Mixin-OAuth-1",{maxReconnectionDelay:5e3,minReconnectionDelay:1e3,reconnectionDelayGrowFactor:1.2,connectionTimeout:8e3,maxRetries:1/0,debug:!1}),r.ws.addEventListener("message",(function(t){if(!r.handled){var c=new FileReader;c.onload=function(){var t=Object(d.ungzip)(new Uint8Array(this.result),{to:"string"}),c=JSON.parse(t);r.callback(c)?r.handled=!0:setTimeout((function(){r.sendRefreshCode(e,n,o,c.data)}),1e3)},c.readAsArrayBuffer(t.data)}})),r.ws.addEventListener("open",(function(t){r.sendRefreshCode(e,n,o)}))}},{key:"sendRefreshCode",value:function(t,e,n,o){this.handled||this.send({id:Object(f.a)().toUpperCase(),action:"REFRESH_OAUTH_CODE",params:{client_id:t,scope:e,code_challenge:n,authorization_id:o?o.authorization_id:""}})}},{key:"send",value:function(t){try{this.ws.send(Object(l.gzip)(JSON.stringify(t)))}catch(t){t instanceof DOMException||console.error(t)}}}]),t}()},1454:function(t,e,n){"use strict";n(1428)},1455:function(t,e,n){var o=n(38)(!1);o.push([t.i,".mixin-logo-overlay[data-v-2fa10296]{border-radius:8px;background-color:#fff}.oauth-qr-background[data-v-2fa10296]{border-radius:8px;background-color:#f2f3f6}.oauth-qr-scanned[data-v-2fa10296]{color:#4caf50;background-color:#e8f5e9;border-radius:50%}.oauth-qr-mobile-background[data-v-2fa10296]{border-radius:8px;background-color:#ebf8ff}.oauth-guide-title[data-v-2fa10296]{font-size:18px;font-weight:600;line-height:21px}.oauth-guide-text[data-v-2fa10296]{color:grey;font-size:14px;font-weight:500px;line-height:150%}",""]),t.exports=o},1549:function(t,e){}}]);